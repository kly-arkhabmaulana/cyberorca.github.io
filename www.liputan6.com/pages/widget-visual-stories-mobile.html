<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>

  <style>
    @font-face {
      font-display: swap;
      font-family: 'AcuminPro';
      src: url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro/AcuminPro.woff') format('woff');
    }
    @font-face {
      font-display: swap;
      font-family: 'AcuminPro Bold';
      src: url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro-Bold/AcuminPro-Bold.woff') format('woff');
    }

    .kly-stories__slider::-webkit-scrollbar-track {
      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
      background-color: #f5f5f5;
    }

    .kly-stories__slider::-webkit-scrollbar {
      /* width: 6px; */
      height: 8px;
      background-color: #f5f5f5;
    }

    .kly-stories__slider::-webkit-scrollbar-thumb {
      background-color: #000000;
    }

    body {
      margin: 0px;
    }

    @font-face {
      font-display: swap;
      font-family: 'AcuminPro-Regular';
      src: url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro/AcuminPro.eot');
      /* IE9 Compat Modes */
      src: url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro/AcuminPro.eot?#iefix') format('embedded-opentype'),
        url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro/AcuminPro.woff') format('woff'),
        url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro/AcuminPro.ttf') format('truetype'),
        url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro/AcuminPro.svg#svgFontName') format('svg');
      /* Legacy iOS */
    }

    @font-face {
      font-display: swap;
      font-family: 'AcuminPro-Bold';
      src: url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro-Bold/AcuminPro-Bold.eot');
      /* IE9 Compat Modes */
      src: url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro-Bold/AcuminPro-Bold.eot?#iefix') format('embedded-opentype'),
        url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro-Bold/AcuminPro-Bold.woff') format('woff'),
        url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro-Bold/AcuminPro-Bold.ttf') format('truetype'),
        url('https://cdn-production-assets-kly.akamaized.net/assets/fonts/liputan6/AcuminPro-Bold/AcuminPro-Bold.svg#svgFontName') format('svg');
      /* Legacy iOS */
    }

    .kly-stories {
      width: 100vw;
      height: auto;
      display: block;
      position: relative;
    }

    .kly-stories__wrapper {
      background-color: #ffffff;
      padding: 0px 0px;
    }

    .kly-stories__header {
      margin: 0 15px 15px;
      font-size: 0;
      /* margin: 0 25px 15px; */
    }

    .kly-stories__header img {
      width: 120px;
      height: 30px;
    }

    .kly-stories__slider {
      display: grid;
      grid-template-columns: 140px 140px;
      grid-column-gap: 20px;
      grid-row-gap: 20px;
      width: 100%;
      list-style-type: none;
      padding: 0px;
      margin: 0;
      padding-bottom: 3px;
      scrollbar-color: #000000 #f5f5f5;
    }

    .kly-stories__slider-background {
      width: 100%;
      height: auto;
    }

    .kly-stories__slider-content {
      position: absolute;
      bottom: 0;
      z-index: 2;
      margin: 0 9px 17px;
    }

    .kly-stories__title {
      font-family: 'AcuminPro-Bold';
      font-size: 12px;
      font-weight: bold;
      line-height: 1.33;
      color: #ffffff;
      margin: 0;
      height: 45px;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
    }

    .kly-stories__slide {
      width: 140px;
      height: 221px;
      -ms-flex-negative: 0;
      flex-shrink: 0;
      -webkit-overflow-scrolling: touch;
      margin-right: 15px;
      position: relative;
    }

    .kly-stories__slide:first-child {
      /* margin-left: 15px; */
    }

    .kly-stories__slide--other a::before {
      background: none;
      background-image: none;
    }

    .kly-stories__link {
      text-decoration: none;
      width: 100%;
      height: 100%;
      display: block;
      overflow: hidden;
    }

    .kly-stories__link::before {
      content: '';
      position: absolute;
      top: 50%;
      bottom: -1%;
      left: 0;
      right: 0;
      background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(0, 0, 0, 0)), to(#0c0c0c));
      background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), #0c0c0c);
      background: -webkit-gradient(linear, left top, left bottom, from(rgba(0, 0, 0, 0)), to(#0c0c0c));
      background: linear-gradient(to bottom, rgba(0, 0, 0, 0), #0c0c0c);
      z-index: 1;
    }

    .kly-stories__content-type {
      margin-bottom: 10px;
    }

    .kly-stories__type {
      font-family: 'AcuminPro-Regular';
      font-size: 10px;
      line-height: 1;
      text-align: center;
      color: #333333;
      border-radius: 3px;
      background-color: #ffffff;
      display: inline-block;
      padding: 6px 6px 3px 6px;
      margin: 0;
      text-transform: uppercase;
    }

    .kly-stories__slide--other .kly-stories__link::before {
      top: 0;
      background-color: rgba(0, 0, 0, 0.7);
    }

    .kly-stories__slide--other .kly-stories__title {
      font-family: 'AcuminPro';
      font-size: 8px;
      font-weight: normal;
      font-style: normal;
      font-stretch: normal;
      line-height: 1;
      letter-spacing: normal;
      text-align: center;
      color: #ffffff;
      margin-top: 10px;
    }

    .kly-stories__slide--other .kly-stories__slider-content {
      position: absolute;
      z-index: 2;
      left: 50%;
      top: 50%;
      -webkit-transform: translate(-50%, -50%);
      transform: translate(-50%, -50%);
      margin: 0;
      height: 72px;
    }

    .kly-stories__icon-other {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='45' height='45' viewBox='0 0 45 45'%3E%3Cg fill='none' fill-rule='evenodd' stroke='%23FFF' transform='translate(3 3)'%3E%3Cpath d='M20.552 9.137l10.229 10.228-10.868 10.868'/%3E%3Cpath stroke-linecap='square' d='M30.5 19.476H9'/%3E%3Ccircle cx='19.5' cy='19.5' r='19.5'/%3E%3C/g%3E%3C/svg%3E%0A");
      background-size: 38px;
      width: 38px;
      height: 38px;
      display: block;
      margin: auto;
    }

    .kly-stories__header {
      margin: 0 -0 15px;
      font-size: 0;
      height: 30px;
      background-repeat: no-repeat;
      background-size: 105px 30px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='25' viewBox='0 0 120 25'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cpath fill='%23000' d='M54.286 0h65v25h-65z'/%3E%3Cg fill='%23FFF'%3E%3Cpath d='M57.921 8.687c0-2.346 1.18-3.687 3.472-3.687 2.293 0 3.472 1.34 3.472 3.687v.461h-2.229v-.607c0-1.048-.428-1.446-1.178-1.446s-1.18.398-1.18 1.446c0 3.016 4.608 3.582 4.608 7.772 0 2.346-1.2 3.687-3.514 3.687-2.315 0-3.515-1.34-3.515-3.687v-.901h2.229v1.047c0 1.048.471 1.425 1.222 1.425.75 0 1.221-.377 1.221-1.425 0-3.016-4.608-3.582-4.608-7.772zM66.571 7.263V5.168h7.287v2.095h-2.465v12.57h-2.357V7.262zM75.714 16.313V8.687C75.714 6.341 76.98 5 79.294 5c2.314 0 3.578 1.34 3.578 3.687v7.626c0 2.346-1.264 3.687-3.579 3.687-2.314 0-3.579-1.34-3.579-3.687zm2.358-7.772v7.918c0 1.048.471 1.446 1.221 1.446.75 0 1.222-.398 1.222-1.446V8.541c0-1.048-.472-1.446-1.222-1.446s-1.221.398-1.221 1.446zM92.743 19.832h-2.4c-.128-.377-.214-.607-.214-1.801v-2.305c0-1.361-.472-1.864-1.543-1.864h-.814v5.97h-2.358V5.168h3.558c2.443 0 3.493 1.11 3.493 3.373v1.152c0 1.508-.493 2.493-1.543 2.975 1.179.481 1.564 1.592 1.564 3.121v2.263c0 .712.022 1.236.257 1.78zm-3.836-12.57h-1.135v4.505h.921c.879 0 1.414-.377 1.414-1.55V8.77c0-1.048-.364-1.508-1.2-1.508zM95.05 19.832V5.168h2.357v14.664zM102.5 7.263v4.085h3.236v2.095H102.5v4.294h4.071v2.095h-6.429V5.168h6.43v2.095zM108.75 8.687c0-2.346 1.178-3.687 3.471-3.687s3.472 1.34 3.472 3.687v.461h-2.229v-.607c0-1.048-.429-1.446-1.179-1.446s-1.178.398-1.178 1.446c0 3.016 4.607 3.582 4.607 7.772 0 2.346-1.2 3.687-3.514 3.687-2.315 0-3.515-1.34-3.515-3.687v-.901h2.229v1.047c0 1.048.471 1.425 1.221 1.425.75 0 1.222-.377 1.222-1.425 0-3.016-4.608-3.582-4.608-7.772z'/%3E%3C/g%3E%3Cpath fill='%23000' d='M2.379 5l1.8 12.236L5.979 5h2.164L5.829 20H2.314L0 5zM10.714 20V5h2.357v15zM15.064 8.771c0-2.4 1.179-3.771 3.472-3.771s3.471 1.371 3.471 3.771v.472H19.78V8.62c0-1.071-.429-1.478-1.179-1.478s-1.179.407-1.179 1.478c0 3.086 4.608 3.665 4.608 7.95 0 2.4-1.2 3.772-3.515 3.772C16.2 20.343 15 18.97 15 16.57v-.921h2.229v1.071c0 1.072.471 1.458 1.221 1.458.75 0 1.221-.386 1.221-1.458 0-3.085-4.607-3.664-4.607-7.95zM24.286 5h2.357v11.571c0 1.072.471 1.458 1.221 1.458.75 0 1.222-.386 1.222-1.458V5h2.228v11.421c0 2.4-1.2 3.772-3.514 3.772s-3.514-1.372-3.514-3.772V5zM39.421 5l2.4 15h-2.378l-.407-2.721h-2.893L35.736 20H33.57l2.4-15h3.45zM37.58 7.657l-1.136 7.586h2.271L37.58 7.657zM43.571 20V5h2.358v12.857h3.878V20z'/%3E%3Cpath d='M0 0h119.286v25H0z'/%3E%3C/g%3E%3C/svg%3E%0A");
    }

    .kly-stories__slide--other a::before {
      background-color: rgba(0, 0, 0, 0) !important;
    }

    /*# sourceMappingURL=index.css.map */
  </style>

  <body>
    <div class="kly-stories">
      <div class="kly-stories__wrapper">
        <div class="kly-stories__header"></div>
        <ul class="kly-stories__slider"></ul>
      </div>
    </div>
  </body>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script>
    $(document).ready(function() {
      $.ajax({
        url: '/pages/json-visual-stories',
        method: 'get',
        success: function(data, success) {
          var parsedData = htmlToJson(data);
          const jsonData = [
            {
              vstory: jsonToArray(parsedData.Sheet1)
            }
          ];

          const arrayHandler = {
            shuffleArray: function(array) {
              let counter = array.length;
              while (counter > 0) {
                let index = Math.floor(Math.random() * counter);
                counter--;
                let temp = array[counter];
                array[counter] = array[index];
                array[index] = temp;
              }
              return array;
            },
            getThreeArray: function(array) {
              const selectedArray = [];
              for (let index = 0; index < 3; index++) {
                selectedArray.push(array[index]);
              }
              return selectedArray;
            }
          };

          const setSlider = {
            getShuffledArray: function() {
              const rawArray = jsonData[0].vstory.slice(jsonData[0].vstory.length - 5, jsonData[0].vstory.length);
              const shuffledArray = arrayHandler.shuffleArray(rawArray);
              const selectedArray = arrayHandler.getThreeArray(shuffledArray);
              return selectedArray;
            },
            sliderCreator: function(imageURL, link, title, categories, index, position) {
              const sliderComponent = `<li class="kly-stories__slide" data-order="${position + 1}" onclick="sendGtmArticle(this)">
                                    <a href="${link}?medium=widget_desktop&campaign=widget_stories_${index}" class="kly-stories__link" target="_blank">
                                        <img src="${imageURL}"
                                            alt="${title}" class="kly-stories__slider-background lazy">
                                        <div class="kly-stories__slider-content">
                                            <div class="kly-stories__content-type">
                                                <span class="kly-stories__type">${categories}</span>
                                            </div>
                                            <h5 class="kly-stories__title">${title}</h5>
                                        </div>
                                    </a>
                                </li>`;
              return sliderComponent;
            },
            getSlidersElementContainer: function() {
              const element = document.querySelector('.kly-stories__slider');
              return element;
            },
            createSlide: function() {
              const parentContainer = this.getSlidersElementContainer();
              const shuffledArray = this.getShuffledArray();

              shuffledArray.forEach(function(element, index) {
                $(parentContainer).append(setSlider.sliderCreator(element.Source_image, element.URL, element.Title, element.Category, element.No, index));
              });
              $(parentContainer).append(
                `
                                <li class="kly-stories__slide kly-stories__slide--other" data-order="lainya" onclick="sendGtmArticle(this)">
                                    <a href="https://www.liputan6.com/visual-stories?medium=widget_desktop&campaign=widget_stories_4" class="kly-stories__link" target="_blank">
                                        <img src="https://d2k3107src8blq.cloudfront.net/liputan6/visualstories/thumbnail-lainnya.jpg"  class="kly-stories__slider-background lazy">
                                        <div class="kly-stories__slider-content">
                                            <i class="kly-stories__icon-other"></i>
                                            <h5 class="kly-stories__title">STORIES LAINYA</h5>
                                        </div>
                                    </a>
                                </li>
                                `
              );
            }
          };

          setSlider.createSlide();
        },
        error: function(error) {
          console.log('resource not found');
        }
      });

      parent.dataLayer.push({
        event: 'impression',
        feature_name: 'ampstories',
        feature_position: 'center'
      });
    });

    function htmlToJson(str) {
      var parser = new DOMParser();
      var el = parser.parseFromString(str, 'text/html').querySelector('body').textContent;
      return JSON.parse(el);
    }

    function jsonToArray(data) {
      var result = [];

      for (i in data) {
        result.push(data[i]);
      }

      return result;
    }

    function sendGtmArticle(element) {
      parent.dataLayer.push({
        event: 'click',
        feature_name: 'ampstories',
        feature_location: 'ampstories',
        feature_position: element.getAttribute('data-order'),
        page_type: 'AMPSTORY'
      });
    }
  </script>
</html>